---
title: "Лабораторная работа №3"
author: Шабанов Р.В.
format:
    md:
        output-file: readme.md
    
editor: visual
---

## Цель Работы

1. Изучить возможности технологии Apache Arrow для обработки и анализ больших
данных
2. Получить навыки применения Arrow совместно с языком программирования R
3. Получить навыки анализа метаинфомации о сетевом трафике
4. Получить навыки применения облачных технологий хранения, подготовки и
анализа данных: Yandex Object Storage, Rstudio Server.

## Ход работы


## Подключение arrow

```{r}
library('dplyr')
library('tidyverse')
library('arrow')
curl::multi_download(
    "https://storage.yandexcloud.net/arrow-datasets/tm_data.pqt",
     "data/tm_data.pqt",
  resume = TRUE
)
df <- arrow::open_dataset('data/tm_data.pqt')
```


## Задание 1

### Найдите утечку данных из Вашей сети

```{r}
leak_traffic <- df %>% select(src, dst, bytes) %>% filter(!str_detect(dst, '1[2-4].*')) %>% collect()
leak_traffic %>% filter(bytes == max(leak_traffic$bytes))
```

## Вывод

Научился пользоваться технологией Apache Arrow для обработки и анализа больших
данных
